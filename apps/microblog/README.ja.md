# iori（庵）

Fediverseに接続された個人向けナレッジ管理プラットフォーム

> **庵（いおり）** — 静かに思索し、知を紡ぎ、世界と繋がる小さな隠れ家

## コンセプト

ioriは、日々の思考を記録・整理するだけでなく、Fediverseを通じて**他者の知識を収集**し、自分の知識を**発信**もできる「**集合知に接続されたセカンドブレイン**」を提供します。

### なぜ作るのか

- 大規模プラットフォームに依存せず、**自分だけの知識基盤**を持ちたい
- 思考を流さず、**蓄積・整理・体系化**したい
- Fediverseから**他者の知識を収集**し、自分の知識と融合させたい
- 必要に応じて、蓄積した知識を**発信・共有**したい

## 主要機能

### 知識の収集

| 機能         | 説明                                             | 状態   |
| ------------ | ------------------------------------------------ | ------ |
| フォロー     | 興味のあるユーザーを購読し、継続的にノートを受信 | 実装済 |
| ブックマーク | 有用なノートを保存し、後で参照・整理             | 未実装 |
| 引用         | 他者のノートに自分の思考を加えて取り込み         | 未実装 |

### 知識の蓄積・整理

| 機能     | 説明                             | 状態   |
| -------- | -------------------------------- | ------ |
| ノート   | 思いつきの記録、メモ（短文）     | 実装済 |
| スレッド | ノートへのリプライで思考を展開   | 実装済 |
| 手記     | スレッドをまとめた長文コンテンツ | 実装済 |
| 全文検索 | 蓄積した知識を検索               | 未実装 |
| タグ     | ノート・手記をタグで分類         | 未実装 |

### 知識の発信

| 機能               | 説明                                         | 状態   |
| ------------------ | -------------------------------------------- | ------ |
| ActivityPub連携    | Mastodon、Misskeyなどと相互運用              | 実装済 |
| いいね・リポスト   | 他者のノートに反応                           | 実装済 |
| 絵文字リアクション | カスタム絵文字で反応                         | 実装済 |
| 通知               | フォロー・いいね・リプライ通知、Web Push対応 | 実装済 |

## 技術スタック

| カテゴリ   | 技術                                                  |
| ---------- | ----------------------------------------------------- |
| Runtime    | Node.js                                               |
| Framework  | [Hono](https://hono.dev/)                             |
| Federation | [Fedify](https://fedify.dev/)                         |
| Database   | PostgreSQL + [Drizzle ORM](https://orm.drizzle.team/) |
| Validation | [Zod](https://zod.dev/)                               |
| Build      | [Vite](https://vite.dev/)                             |

## セットアップ

### 必要環境

- Node.js 24.x
- pnpm
- PostgreSQL 15+

### インストール

1. データベースを起動

```bash
pnpm compose:up
```

2. 環境変数を設定

```bash
cp .env.example .env
# .env を編集
```

必須の環境変数:

| 変数           | 説明                                               |
| -------------- | -------------------------------------------------- |
| `DATABASE_URL` | PostgreSQL接続文字列                               |
| `ORIGIN`       | サーバーのオリジンURL（例: `https://example.com`） |

3. データベースマイグレーション

```bash
pnpm drizzle:push
```

4. 開発サーバー起動

```bash
pnpm dev
```

## 開発

```bash
# 開発サーバー起動
pnpm dev

# テスト実行
pnpm test

# Lint & Format
pnpm lint:fix
pnpm format

# 型チェック
pnpm exec tsc --noEmit

# 本番ビルド
pnpm build
```

## アーキテクチャ

```
src/
├── adaptor/       # インフラ層（ルーティング、DB、フェデレーション）
├── domain/        # ドメインモデル、ビジネスロジック
├── useCase/       # アプリケーションユースケース
├── ui/            # UIコンポーネント、ページ
├── federation.ts  # ActivityPub設定
└── app.tsx        # エントリポイント
```

## ドキュメント

詳細なドキュメントは `docs/` ディレクトリを参照してください。

### RDRA（要件定義）

| ドキュメント                                          | 内容                                     |
| ----------------------------------------------------- | ---------------------------------------- |
| [System Value](docs/rdra/system-value.md)             | プロダクトビジョン、アクター、要求・要件 |
| [System Environment](docs/rdra/system-environment.md) | 利用シーン、ビジネスユースケース         |
| [Information Model](docs/rdra/information-model.md)   | ドメインモデル、集約、イベント           |
| [State Model](docs/rdra/state-model.md)               | 状態遷移、ビジネスルール                 |

### 開発者向け

| ドキュメント     | 内容                   |
| ---------------- | ---------------------- |
| [ADR](docs/adr/) | アーキテクチャ決定記録 |

## 用語集

| 用語         | 定義                                 |
| ------------ | ------------------------------------ |
| **ノート**   | 日々の思考を記録する短いテキスト     |
| **スレッド** | ノートへのリプライの連鎖。思考の展開 |
| **手記**     | スレッドをまとめたもの。思考の軌跡   |

## ライセンス

MIT
