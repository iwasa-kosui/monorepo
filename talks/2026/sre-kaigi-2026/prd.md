# セッションPRD: 医療SaaS企業を支える共通基盤の挑戦

## 1. 要求（Requirements）

本セッションに対して、主催者・聴講者が持つ要求を以下にまとめる。

### 1.1 主催者の要求

SRE Kaigi 2026の採択セッション傾向から、主催者は以下を期待していると推測される。

| 要求ID | 要求 | 優先度 |
|--------|------|--------|
| R-H1 | **Enabling / 非SREへの展開**: SRE専任でない開発チームが信頼性向上に取り組む再現可能なモデルケースを提示すること | 必須 |
| R-H2 | **具体的なアーキテクチャ事例**: 抽象論ではなく、実装可能な設計パターンを含むこと | 必須 |
| R-H3 | **ミッションクリティカル領域の知見**: 医療という希少なドメインの経験を共有すること | 推奨 |
| R-H4 | **他業界への適用可能性**: 医療特有の話に閉じず、金融・公共などにも適用可能な形で抽象化すること | 推奨 |

### 1.2 聴講者の要求（ペルソナ別）

#### ペルソナA: 小規模チームのテックリード「田中さん」

**プロフィール**:
- 32歳、シリーズBスタートアップ（社員50名）でチーム5名をリード
- SRE専任を採用する余裕がないが、プロダクト成長に伴い障害が増加
- 「正社員1名、業務委託2-3名」という規模感に共感して参加

**ストーリー**:
> 「最近プロダクトが成長して障害も増えてきた。SREを採用したいけど、今のフェーズでは難しい。開発チームだけでできることはないだろうか...」

| 要求ID | 要求 | 優先度 |
|--------|------|--------|
| R-A1 | 少人数でも実践できる信頼性向上の優先順位を示すこと | 必須 |
| R-A2 | ドメインイベントによるトレーサビリティの導入コスト感を伝えること | 必須 |
| R-A3 | 「SREを雇う前にやるべきこと」のリストを提供すること | 推奨 |

#### ペルソナB: 共通基盤エンジニア「鈴木さん」

**プロフィール**:
- 37歳、マルチプロダクトSaaS企業（社員200名）で認証基盤を担当
- 各プロダクトが独自実装しており品質がバラバラ
- 共通化を3年前から提案しているが、政治的に進まない

**ストーリー**:
> 「認証周りを共通化したいと言っているが、プロダクトチームは『今は忙しい』の一点張り。実際に成功した事例を見せて、経営層を説得したい」

| 要求ID | 要求 | 優先度 |
|--------|------|--------|
| R-B1 | OpenID Connectを軸にした認証基盤の設計パターンを示すこと | 必須 |
| R-B2 | データ連携 vs API連携 vs イベント連携の判断基準を明確にすること | 必須 |
| R-B3 | 共通基盤チームの「やらないこと」の線引きを示すこと | 推奨 |

#### ペルソナC: 規制産業のエンジニア「佐藤さん」

**プロフィール**:
- 28歳、地方銀行のシステム子会社でバックエンド担当
- FISC安全対策基準への対応で疲弊
- 医療と金融で課題が似ていると感じてSRE Kaigi初参加

**ストーリー**:
> 「うちも厳しいセキュリティ要件があるけど、毎回個別対応で疲弊している。基盤レベルで解決した事例を知りたい」

| 要求ID | 要求 | 優先度 |
|--------|------|--------|
| R-C1 | 規制対応をアーキテクチャで解決するパターンを示すこと | 必須 |
| R-C2 | RLSによるテナント分離の具体的な実装と落とし穴を共有すること | 必須 |
| R-C3 | 監査ログ・多要素認証の設計アプローチを説明すること | 推奨 |

#### ペルソナD: SREイネイブラー「山田さん」

**プロフィール**:
- 35歳、メガベンチャーの横断SREチーム所属
- Embedded SREとして開発チームを支援しているが、知見移転がうまくいかない
- 「結局SREがやった方が早い」状態から脱却したい

**ストーリー**:
> 「開発チームに自走してほしいのに、いつまでも依存される。開発チームが自発的に信頼性向上に取り組んだ事例があれば、Enablingのゴール像が見えるのに」

| 要求ID | 要求 | 優先度 |
|--------|------|--------|
| R-D1 | 開発チームが自律的に信頼性を担うための前提条件を示すこと | 必須 |
| R-D2 | Enablingで伝えるべきアーキテクチャパターンを具体化すること | 推奨 |
| R-D3 | 「Embedded SREの終わり」に向けたヒントを提供すること | 推奨 |

### 1.3 ユーザーストーリー形式での要求

```
AS A   小規模チームのテックリード
I WANT SRE専任なしで実践できる信頼性向上の具体例を知りたい
SO THAT 自チームで優先的に取り組むべき施策を判断できる
```

```
AS A   共通基盤チームのエンジニア
I WANT 認証基盤・データ配信の設計パターンを知りたい
SO THAT 自社の共通基盤設計の参考にでき、経営層への説得材料にできる
```

```
AS A   規制産業のエンジニア
I WANT 規制対応をアーキテクチャで解決した事例を知りたい
SO THAT コンプライアンス要件を効率的に満たせる
```

```
AS A   SREイネイブラー
I WANT 開発チームが自律的に信頼性を担った事例を知りたい
SO THAT Enablingの目標状態を具体化し、開発チームに示せる
```

```
AS A   SRE Kaigi主催者
I WANT 「非SREによる信頼性向上」の再現可能なモデルケースを提供したい
SO THAT SRE実践の裾野を広げられる
```

### 1.4 要求のトレーサビリティマトリクス

各要求がどのコンテンツセクションで満たされるかを示す。

| 要求ID | セクション | 具体的な内容 |
|--------|-----------|-------------|
| R-H1 | 背景・結果 | チーム体制（正社員1名）と成果を提示 |
| R-H2 | 解決策 | RLS、Outbox、Delta Lake、ドメインイベントの設計パターン |
| R-H3 | 背景 | 3省2ガイドライン、医療業界の特性 |
| R-H4 | 各セクション | 「他業界での適用可能性」を都度言及 |
| R-A1, R-A3 | まとめ | 「SREを雇う前にやるべきこと」リスト |
| R-A2 | 解決策（アプリ） | ドメインイベント導入の工数感 |
| R-B1 | 解決策（認証） | OpenID Connect活用パターン |
| R-B2 | 解決策（データ配信） | 3つの連携方式の比較表 |
| R-B3 | 背景・解決策 | 認可は各プロダクトに委譲した事例 |
| R-C1, R-C2, R-C3 | 解決策（インフラ） | RLS、監査ログ、MFA |
| R-D1, R-D2 | 結果と教訓 | 開発チームが自走できた条件 |
| R-D3 | まとめ | Enabling完了後の状態として提示 |

---

## 2. 概要

### セッション情報

| 項目 | 内容 |
|------|------|
| タイトル | 開発チームが信頼性向上のためにできること: 医療SaaS企業を支える共通基盤の挑戦 |
| イベント | SRE Kaigi 2026 |
| 発表日 | 2026/01/31 |
| 形式 | セッション（30分） |
| カテゴリ | Architecture: SREの視点からのシステム設計 |

### 背景と目的

**背景**:
SRE Kaigi 2026では「Enabling SRE」「組織横断的なSRE」がトレンドとなっている。一方で、SRE専任チームを持たない組織が信頼性向上に取り組む具体的な事例は少ない。

**目的**:
SREという役割を持たない開発チームが、アーキテクチャ設計を通じてサービスの信頼性を向上させる方法を、医療SaaS企業の実例を通じて提示する。

### キーメッセージ

> **「SREという役割がなくても、アーキテクチャの選択で信頼性は担保できる」**

---

## 3. 成功指標

### 定量指標

| 指標 | 目標 |
|------|------|
| セッション満足度 | 4.0 / 5.0 以上 |
| X (Twitter) 言及数 | 30件以上 |
| 資料閲覧数（公開後1週間） | 3,000 PV以上 |
| 登壇後の問い合わせ・DM | 5件以上 |

### 定性指標

- 「自分のチームでも実践できそう」という感想が得られる
- 「SRE専任がいなくてもここまでできるのか」という気づきを与える
- 具体的なアーキテクチャパターンが記憶に残る

---

## 4. スコープ（Scope）

### スコープ内（In Scope）

| カテゴリ | 内容 |
|----------|------|
| 課題設定 | 医療SaaSにおける品質要件の相反、トレーサビリティの欠如 |
| 解決策（インフラ） | PostgreSQL RLS、DynamoDB + Outboxパターン、Delta Lake形式でのデータ配信 |
| 解決策（アプリ） | ドメインイベントの永続化、サービスベースアーキテクチャ |
| 結果と教訓 | 開発効率向上、障害調査時間短縮、RLSの落とし穴、共通ライブラリの危険性 |
| 再現可能性 | 他業界・他組織でも適用可能なパターンの抽象化 |

### スコープ外（Out of Scope）

| カテゴリ | 理由 |
|----------|------|
| 組織マネジメント・プロセス改善 | 技術セッションの焦点を維持するため |
| 特定ツール・ベンダーの詳細比較 | 汎用性を確保するため |
| カケハシの事業・プロダクト詳細 | 守秘義務および本質から逸れるため |
| SREチームの立ち上げ方法 | セッションの主張と矛盾するため |

---

## 5. コンテンツ要件

### アウトライン（30分）

| セクション | 時間 | 内容 |
|------------|------|------|
| **導入** | 3分 | 自己紹介、カケハシ概要、セッションの目的 |
| **背景** | 5分 | 医療業界の特性、マルチプロダクト展開、チーム体制（正社員1名） |
| **課題** | 4分 | 品質要求の相反、トレーサビリティの欠如 |
| **解決策** | 12分 | インフラレイヤ（RLS、DynamoDB、Delta Lake）、アプリレイヤ（ドメインイベント、サービスベースアーキテクチャ） |
| **結果と教訓** | 4分 | 成果（開発効率、障害調査時間）、失敗から学んだこと |
| **まとめ** | 2分 | キーメッセージの再提示、持ち帰りポイント |

### キーメッセージの配置

| タイミング | メッセージ |
|------------|-----------|
| 導入 | 「SREという役割がなくても、アーキテクチャの選択で信頼性は担保できる」 |
| 課題提示後 | 「限られたリソースだからこそ、設計で解決する」 |
| 解決策提示中 | 「この設計パターンは医療以外でも適用可能」 |
| まとめ | 「開発者自身がサービスの信頼性を向上させられる」 |

### 必須コンテンツ

#### 図解・ダイアグラム

1. **全体アーキテクチャ図**: 認証基盤・アカウント基盤・アセット基盤・データ基盤の関係
2. **データ連携パターン比較表**: データ連携 vs API連携 vs イベント連携
3. **RLSの仕組み図**: 行レベルセキュリティによるテナント分離
4. **Outboxパターン図**: DynamoDB + EventBridgeによるイベント配信
5. **Delta Lakeタイムトラベル図**: 過去状態の参照によるトレーサビリティ

#### 具体的な数値・事例

| 項目 | Before | After |
|------|--------|-------|
| 新プロダクト開発時の認証実装コスト | X人月 | Y人月（大幅削減） |
| 障害発生時の原因特定時間 | X時間 | Y時間（短縮） |
| チーム規模 | 正社員1名 + 業務委託2-3名 | - |

### オプショナルコンテンツ（時間があれば）

- OpenID Connectの柔軟な活用例
- スナップショットからのイベント生成の詳細
- 今後の展望（契約基盤、アカウント基盤の抽象化）

---

## 6. 制約条件

### 時間制約

- 発表時間: 30分（質疑応答は別枠の場合あり）
- 準備期間: 〜2026/01/31

### 技術的制約

- 守秘義務: 具体的な数値・内部システム名は抽象化が必要
- スライド形式: イベント指定のフォーマットに準拠

### 表現上の制約

- 専門用語の説明: RLS、Outbox、Delta Lakeは初見でも理解できる説明を付与
- ベンダー中立: 特定ツールの宣伝にならないよう配慮

---

## 7. リスクと対策

| リスク | 影響度 | 対策 |
|--------|--------|------|
| 時間超過 | 高 | 各セクションの時間配分を厳守、リハーサルで計測 |
| 内容が抽象的すぎる | 高 | 具体的なコード例・設定例をスライドに含める |
| 医療特有の話に偏る | 中 | 各解決策で「他業界での適用可能性」を明示 |
| SREコミュニティに響かない | 中 | ペルソナDの視点を意識し、Enabling文脈での価値を強調 |
| 技術的な質問に答えられない | 低 | 想定Q&Aを事前に準備 |

---

## 8. 想定Q&A

### 技術的な質問

**Q: RLSのパフォーマンスへの影響は？**
> A: クエリプランへの影響を計測し、インデックス設計で対応。具体的なベンチマーク結果は〜。

**Q: Delta Lakeの即時性の課題をどう解決した？**
> A: リアルタイム性が必要なケースはAPI/イベント連携を併用。ユースケースに応じた使い分けが重要。

**Q: サービスベースアーキテクチャとマイクロサービスの違いは？**
> A: 単一DBを共有し、サービス間通信を原則禁止。強い整合性が必要な場合に有効。

### 組織・プロセスに関する質問

**Q: 開発チームだけで本当に信頼性を担保できる？**
> A: 完全ではない。SREチームとの連携（オブザーバビリティ、インシデント対応）は別途存在。本セッションはアーキテクチャ設計の範囲に限定。

**Q: 共通基盤チームの立ち上げ方は？**
> A: スコープ外だが、必要であれば懇親会等で共有可能。

---

## 9. 参考資料

### 公開済み資料

- [Authlete と AWS を活用した認証プラットフォーム構築](https://speakerdeck.com/kakehashi/building-an-authentication-platform-using-authlete-and-aws)
- [カケハシ開発者ブログ](https://kakehashi-dev.hatenablog.com/entry/2024/09/19/110000)
- [Findy Tools インタビュー](https://findy-tools.io/companies/kakehashi/91/97)

### 関連セッション（SRE Kaigi 2026）

- 「Embedded SREの終わりを設計する」- Enabling完了後の状態として参照
- 「制約が導く迷わない設計」- 設計原則の観点で関連
- 「Sansanの認証基盤のこれまでとこれから」- 認証基盤の比較対象

---

## 改訂履歴

| 日付 | バージョン | 変更内容 |
|------|-----------|----------|
| 2026/01/17 | 1.0 | 初版作成 |
